# Milestone v1.1: List Drag-and-Drop

**Status:** ✅ SHIPPED 2026-03-01
**Phases:** 1–1
**Total Plans:** 3

## Overview

v1.0 shipped full card drag-and-drop (within lists and between lists) using
`@hello-pangea/dnd`. List columns were already `Droppable type="CARD"` containers
but were not yet `Draggable` themselves. The backend reorder endpoint
(`PATCH /api/lists/reorder`) was already implemented and accepted
`{ lists: [{ id, position }] }` — a frontend body-key mismatch was the only
server-side fix needed.

v1.1 wired up the remaining DnD layer: wrapping the columns container in a
horizontal `Droppable`, each column in a `Draggable`, dispatching list moves
through a new `useMoveList` hook (modelled after `useMoveCard`), and fixing the
frontend API helper.

## Phases

### Phase 1: Enable List Drag-and-Drop

**Goal:** Users can grab any list column by its header and drag it left or right to
reorder it. The new order is visible immediately (optimistic update), is saved
to the server, and survives a page refresh. If the server call fails the board
reverts to the pre-drag order automatically.

**Depends on:** v1.0 baseline (backend PATCH /api/lists/reorder already exists)
**Plans:** 3 plans

Plans:
- [x] 01-01-PLAN.md — Fix reorderLists body key + add useMoveList hook (API/hook layer)
- [x] 01-02-PLAN.md — Update ListColumn + AddListForm component props
- [x] 01-03-PLAN.md — Wire BoardPage.jsx for list drag-and-drop (board orchestration)

**Requirements covered:**

| Req ID  | Description                                                        | Status     |
| ------- | ------------------------------------------------------------------ | ---------- |
| LIST-04 | User can drag a list column left/right to reorder it on the board  | ✅ done    |
| LIST-05 | Reordered position persists after page refresh (saved to server)   | ✅ done    |
| LIST-06 | Board UI updates immediately after drop (optimistic + rollback)    | ✅ done    |
| FIX-01  | `reorderLists()` body key corrected from `items` to `lists`        | ✅ done    |

**Files modified:**

| File                                        | Change summary                                               |
| ------------------------------------------- | ------------------------------------------------------------ |
| `frontend/src/api/lists.js`                 | Rename param + body key: `items` → `lists`                   |
| `frontend/src/hooks/useBoardDetail.js`      | Add `useMoveList` export; add `reorderLists` import          |
| `frontend/src/components/ListColumn.jsx`    | Accept `dragHandleProps` + `isDragging`; header-only handle  |
| `frontend/src/components/AddListForm.jsx`   | Accept `disabled` prop; gates all interactive elements       |
| `frontend/src/pages/BoardPage.jsx`          | Outer Droppable type=LIST; per-column Draggable; LIST branch in handleDragEnd; useMoveList wired |

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**

- Body key corrected `items→lists` in `reorderLists()` to match existing backend PATCH /api/lists/reorder contract
- `useMoveList` mirrors `useMoveCard` pattern exactly: cancel → snapshot → setQueryData → rollback on error → invalidate on settled
- `dragHandleProps` spread on column header Box only (not Paper) so only grabbing the header initiates a drag
- `disabled` prop layered with `||` on existing `isPending` guard — both conditions respected
- `sortedLists` hoisted above handlers in BoardPage so drag logic references stable sorted array
- Clean 1000-increment integer positions on every reorder to prevent float drift
- `setIsDraggingList` reset in `handleDragEnd` always (even on no-destination drop) to avoid stuck state

**Issues Resolved:**

- Frontend/backend body key mismatch (`items` vs `lists`) on PATCH /api/lists/reorder
- List columns were not Draggable despite existing DnD infrastructure

**Issues Deferred:**

- None for this milestone

**Technical Debt Incurred:**

- None — position algorithm may need a rebalance after extreme number of reorders (existing pattern, not new)

---

_Archived: 2026-03-01 as part of v1.1 milestone completion_
_For current project status, see .gsd/ROADMAP.md_
